<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to rotate paleocoordinates with the GPlates Web Service
">
<title>3. Reconstructions based on given paleocoordinates (online) • rgplates</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="3. Reconstructions based on given paleocoordinates (online)">
<meta property="og:description" content="Learn how to rotate paleocoordinates with the GPlates Web Service
">
<meta property="og:image" content="https://gplates.github.io/rgplates/reference/figures/logo.png">
<meta property="og:image:alt" content="The rgplates sticker.">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@atkocsis">
<meta name="twitter:site" content="@atkocsis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rgplates</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/1_installation.html">1. Installation</a>
    <a class="dropdown-item" href="../articles/2_online_reconstruction_backwards.html">2. Online Reconstruction with the GWS</a>
    <a class="dropdown-item" href="../articles/3_online_reconstrution_forward.html">3. Online Reconstruction using paleocoordinates</a>
    <a class="dropdown-item" href="../articles/4_offline_reconstruction.html">4. Offline Reconstruction</a>
    <a class="dropdown-item" href="../articles/5_reconstruction_with_chronosphere.html">5. Reconstruction with chronosphere Data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-internals">Internals</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-internals">
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
    <a class="dropdown-item" href="../articles/internals.html">Internal structure</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.evolv-ed.net/">How-to guides on EvolvED</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gplates/rgplates/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>3. Reconstructions based on given paleocoordinates (online)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gplates/rgplates/blob/HEAD/vignettes/3_online_reconstrution_forward.Rmd" class="external-link"><code>vignettes/3_online_reconstrution_forward.Rmd</code></a></small>
      <div class="d-none name"><code>3_online_reconstrution_forward.Rmd</code></div>
    </div>

    
    
<p>The <a href="https://gws.gplates.org/" class="external-link">GPlates Web Service (GWS)</a>
(<strong>online</strong>) implements reverse reconstruction: rather than
calculating the paleocoordinates of present-day positions given an
<em>age</em> and a <em>model</em>, you can calculate the present-day
positions of paleocoordinates.</p>
<div class="section level2">
<h2 id="present-day-positions-of-paleocoordinates">Present-day positions of paleocoordinates<a class="anchor" aria-label="anchor" href="#present-day-positions-of-paleocoordinates"></a>
</h2>
<hr>
<p>Let’s work with the Triassic (at 220Ma) using the default
<code>"MERDITH2021"</code> model! We can reconstruct the positions of
present-day coastlines as we saw earlier</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coast220</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="st">"coastlines"</span>, age<span class="op">=</span><span class="fl">220</span><span class="op">)</span></span>
<span><span class="va">coast220</span></span>
<span><span class="co">#&gt; Simple feature collection with 2219 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -179.99 ymin: -82.3516 xmax: 179.99 ymax: 89.99</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                          geometry</span></span>
<span><span class="co">#&gt; 1  POLYGON ((164.7667 58.5746,...</span></span>
<span><span class="co">#&gt; 2  POLYGON ((171.5001 53.1643,...</span></span>
<span><span class="co">#&gt; 3  POLYGON ((162.0057 55.6797,...</span></span>
<span><span class="co">#&gt; 4  POLYGON ((160.0406 54.5613,...</span></span>
<span><span class="co">#&gt; 5  POLYGON ((162.1421 56.2415,...</span></span>
<span><span class="co">#&gt; 6  POLYGON ((174.0752 53.7632,...</span></span>
<span><span class="co">#&gt; 7  POLYGON ((162.533 56.3312, ...</span></span>
<span><span class="co">#&gt; 8  POLYGON ((161.9085 56.184, ...</span></span>
<span><span class="co">#&gt; 9  POLYGON ((158.8934 55.3449,...</span></span>
<span><span class="co">#&gt; 10 POLYGON ((158.0967 55.2248,...</span></span></code></pre></div>
<p>We can also plot this the same way:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the background map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coast220</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"gray"</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="3_online_reconstrution_forward_files/figure-html/background-1.png" width="960"></p>
<p>Working with this reconstruction often involves defining points in
this paleocoordinate system: either because they represent notable
geographic positions, or they are results of geometric
transformations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the coordinates</span></span>
<span><span class="va">one</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="op">-</span><span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">45</span><span class="op">)</span></span>
<span><span class="va">three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">60</span>, <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make it a matrix</span></span>
<span><span class="va">posMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">one</span>, <span class="va">two</span>, <span class="va">three</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># add column names (optional)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">posMat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"paleolong"</span>, <span class="st">"paleolat"</span><span class="op">)</span></span>
<span><span class="va">posMat</span></span>
<span><span class="co">#&gt;       paleolong paleolat</span></span>
<span><span class="co">#&gt; one         -15      -25</span></span>
<span><span class="co">#&gt; two         100      -45</span></span>
<span><span class="co">#&gt; three       -60       30</span></span></code></pre></div>
<p>Since the map above is using the <code>WGS84</code> Coordinate
Reference System (CRS), we can visualize the positions with
<code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">posMat</span>, col<span class="op">=</span><span class="st">"red"</span>, pch<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="3_online_reconstrution_forward_files/figure-html/plotPoints-1.png" width="960"></p>
<p>You can calculate the present-day positions of these points with the
<code><a href="../reference/reconstruct.html">reconstruct()</a></code> function - you only have to indicate that the
coordinates are <strong>from</strong> a given age, in our case
<strong>220Ma</strong>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">presentPoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="va">posMat</span>, from<span class="op">=</span><span class="fl">220</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in gwsReconstructPoints(coords = x[bPresent, , drop = FALSE], time = from, : Identical coordinates returned as present-day positions (4 digits): </span></span>
<span><span class="co">#&gt;   - Some points are probably off the partitioning polygons.</span></span>
<span><span class="co">#&gt;   - Returning NAs for these.</span></span></code></pre></div>
<p>Note the warning message! This reads a bit technical, but the key bit
here is the first bullet point: <strong>Some points are probably off the
partitioning polygons.</strong> This simply means that calculating the
present-day positions is simply not possible because the
paleocoordinates cannot be assigned to any of the plates that are
present in the model at the time indicated by the <strong>from</strong>
argument. These points are indicated with missing values
(<code>NA</code>s`) in the returned object of present-day
coordinates.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">presentPoints</span></span>
<span><span class="co">#&gt;           long      lat</span></span>
<span><span class="co">#&gt; one   -57.5362 -12.9236</span></span>
<span><span class="co">#&gt; two   132.5350 -25.1888</span></span>
<span><span class="co">#&gt; three       NA       NA</span></span></code></pre></div>
<p>This result indicates that the point named <code>"three"</code> (with
coordinates <code>-60</code> <code>30</code>) is probably off the
plates. We can confirm this by looking at plates themselves
(<code>static_polygons</code> for the <code>"MERDITH2021"</code> model).
These can be queried with:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl220</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="st">"static_polygons"</span>, age<span class="op">=</span><span class="fl">220</span><span class="op">)</span></span></code></pre></div>
<p>… and plotted on top of the existing map with:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pl220</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"#00555522"</span>, add<span class="op">=</span><span class="cn">TRUE</span>, border<span class="op">=</span><span class="st">"#00555533"</span><span class="op">)</span></span></code></pre></div>
<p><img src="3_online_reconstrution_forward_files/figure-html/staticsActual-1.png" width="960"></p>
<p>The point in question indeed does not fall on any of the plates.</p>
<div class="section level4">
<h4 id="off-plate-points">Off-plate points<a class="anchor" aria-label="anchor" href="#off-plate-points"></a>
</h4>
<p>Keeping these missing value points is highly beneficial - it helps us
organize our data more efficiently. However, if you regularly work with
coordinates that are off the plates, the warnings that you saw above
might be somewhat disruptive. For example, if you want to find the
present-day coordiantes of a bunch of points, such as these coming from
the tropics of 220Ma:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># random points from the tropics, set seed to make them reproducible</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># note that these are not uniformly distributed in space!</span></span>
<span><span class="va">tropoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>    paleolong<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">200</span>, <span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span><span class="op">)</span>,</span>
<span>    paleolat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">200</span>, <span class="op">-</span><span class="fl">30</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Which you can visualize with</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># static polygons from 220Ma </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pl220</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"#00555522"</span>, border<span class="op">=</span><span class="st">"#00555533"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># points</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">tropoints</span>, pch<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="3_online_reconstrution_forward_files/figure-html/tropointsvis-1.png" width="960"></p>
<p>Then you can turn of the warnings for the no plate assignment with
the <code>warn</code> argument of <code><a href="../reference/reconstruct.html">reconstruct()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tropoints0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="va">tropoints</span>, from<span class="op">=</span><span class="fl">220</span>, warn<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The missing values in this <code>matrix</code> indicate the presence
of points that are off the static polygons:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># which present-day longitude values are missing? </span></span>
<span><span class="co"># Prvodide row indices</span></span>
<span><span class="va">indMissing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tropoints0</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can use these to visualize that the points are on or off the
polygons - for example we ca circle them on our previously plotted
map:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># circle off-polygon points</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">tropoints</span><span class="op">[</span><span class="va">indMissing</span>,<span class="op">]</span>, pch<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="3_online_reconstrution_forward_files/figure-html/tropMissVisActual-1.png" width="960"></p>
</div>
<div class="section level4">
<h4 id="present-day-positions-of-the-coordinates">Present-day positions of the coordinates<a class="anchor" aria-label="anchor" href="#present-day-positions-of-the-coordinates"></a>
</h4>
<p>Going back to the three points that we were inspecting earlier
(<code>posMat</code>): the present-day coordinates are given as
longitude (<code>long</code>) and latitude (<code>lat</code>) values in
the <code>presentPoints</code> matrix object. We can visualize them on
any map that has a <code>WGS84</code> CRS. For instance we can grab the
coaslines of the <code>"MERDITH2021"</code> model, and plot them the
usual way</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Present-day coastlines today</span></span>
<span><span class="va">coast0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="st">"coastlines"</span>, age<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># Plot outlines</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coast0</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"gray"</span>, border<span class="op">=</span><span class="st">"darkgray"</span><span class="op">)</span></span></code></pre></div>
<p><img src="3_online_reconstrution_forward_files/figure-html/presentCoast-1.png" width="960"></p>
<p>… and use points to put the positions on the map:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot present-day positions of the points </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">presentPoints</span>, col<span class="op">=</span><span class="st">"red"</span>, pch<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="3_online_reconstrution_forward_files/figure-html/plotPresentPointsActual-1.png" width="960"></p>
<p>Note that the missing values will not be rendered.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="tracing-points-from-paleocoordinates">Tracing points from paleocoordinates<a class="anchor" aria-label="anchor" href="#tracing-points-from-paleocoordinates"></a>
</h2>
<hr>
<p>If we can reconstruct the present-day positions of points of past
paleocoordinates, that also means that we can reconstruct their
positions at other points in time as well.</p>
<div class="section level4">
<h4 id="paleocoordinates-at-other-times">Paleocoordinates at other times<a class="anchor" aria-label="anchor" href="#paleocoordinates-at-other-times"></a>
</h4>
<p>If we want to calculate the positions of the three points above (or
at least those two that are on actual plates), for <strong>10 million
years earlier</strong> (i.e. to 230Ma), all we need to do is to change
the target <code>age</code> of the reconstruction. This argument of
<code>recontruct()</code> defaults to <code>0</code>: the date that
represents the present. This is the same target <code>age</code> that we
normally use for calculating the paleocoordinates of present-day
locations, but by providing a <code>from</code> argument as well, we can
indicate that the given coordinates actually represent
paleocoordinates.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paleocoordinates of 220Ma rotated to 230Ma</span></span>
<span><span class="va">pm230</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="va">posMat</span>, from<span class="op">=</span><span class="fl">220</span>, age<span class="op">=</span><span class="fl">230</span>, warn<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>You can visualize the offset of these points by calculating the
positions of the coastlines (as earlier):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paleocoordinates of 220Ma rotated to 230Ma</span></span>
<span><span class="va">coast230</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="st">"coastlines"</span>, age<span class="op">=</span><span class="fl">230</span><span class="op">)</span></span></code></pre></div>
<p>… and plotting the information from both the 220Ma and 230Ma time
interval on the same figure, using different colors:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 220Ma (gray and black)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coast220</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"gray"</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">posMat</span>, col<span class="op">=</span><span class="st">"black"</span>, pch<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 230Ma (red) - use add to overlplot!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coast230</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"#BB000022"</span>, border<span class="op">=</span><span class="cn">NA</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">pm230</span>, col<span class="op">=</span><span class="st">"#BB0000"</span>, pch<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="3_online_reconstrution_forward_files/figure-html/fullMaps-1.png" width="960"></p>
<p>You can visually evaluate the offset between these two time intervals
or you can use the coordinates in other calculations.</p>
</div>
<div class="section level4">
<h4 id="tracing-the-points-evolution-to-the-present">Tracing the points’ evolution to the present<a class="anchor" aria-label="anchor" href="#tracing-the-points-evolution-to-the-present"></a>
</h4>
<hr>
<p>If you can reconstruct the positions of paleocoordinates for single
times, or you can do it for multiple target <code>age</code>s by
iterating the call to <code><a href="../reference/reconstruct.html">reconstruct()</a></code>. To make this easier,
you can provide a set of dates in the <code>age</code> argument, which
will calculate all the paleo- (if <code>from</code> is not
<code>0</code>) or recent (<code>from=0</code>) coordinates for every
given age. For instance, if you want to trace the positions of these
points until the present day (say in steps of 10Ma), all you need to do
is provide a vector with multiple target <code>age</code>s:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># vector of target ages (steps of 10Ma)</span></span>
<span><span class="va">allAges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run the reconstruction</span></span>
<span><span class="co"># will take a couple seconds</span></span>
<span><span class="va">pmHistoryList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="va">posMat</span>, from<span class="op">=</span><span class="fl">220</span>, age<span class="op">=</span><span class="va">allAges</span>, warn<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The default behavior of the function is to return a <code>list</code>
of results: one for every target <code>age</code> - as if you were
running the <code><a href="../reference/reconstruct.html">reconstruct()</a></code> separately for these target
<code>age</code>s:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first 6 elements of the list</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pmHistoryList</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`220`</span></span>
<span><span class="co">#&gt;       paleolong paleolat</span></span>
<span><span class="co">#&gt; one         -15      -25</span></span>
<span><span class="co">#&gt; two         100      -45</span></span>
<span><span class="co">#&gt; three        NA       NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`210`</span></span>
<span><span class="co">#&gt;       paleolong paleolat</span></span>
<span><span class="co">#&gt; one    -13.8011 -23.8324</span></span>
<span><span class="co">#&gt; two     98.0900 -43.2016</span></span>
<span><span class="co">#&gt; three        NA       NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`200`</span></span>
<span><span class="co">#&gt;       paleolong paleolat</span></span>
<span><span class="co">#&gt; one    -13.2429 -21.3120</span></span>
<span><span class="co">#&gt; two     96.4196 -44.1218</span></span>
<span><span class="co">#&gt; three        NA       NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`190`</span></span>
<span><span class="co">#&gt;       paleolong paleolat</span></span>
<span><span class="co">#&gt; one    -13.1015 -19.5392</span></span>
<span><span class="co">#&gt; two     95.4666 -45.4731</span></span>
<span><span class="co">#&gt; three        NA       NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`180`</span></span>
<span><span class="co">#&gt;       paleolong paleolat</span></span>
<span><span class="co">#&gt; one    -13.5507 -17.7555</span></span>
<span><span class="co">#&gt; two     95.1759 -48.7927</span></span>
<span><span class="co">#&gt; three        NA       NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`170`</span></span>
<span><span class="co">#&gt;       paleolong paleolat</span></span>
<span><span class="co">#&gt; one    -14.4549 -16.2838</span></span>
<span><span class="co">#&gt; two     97.6837 -54.2356</span></span>
<span><span class="co">#&gt; three        NA       NA</span></span></code></pre></div>
<p>The individual elements of the list are the same objects as the
results of the previous calls of <code><a href="../reference/reconstruct.html">reconstruct()</a></code>. The
<code>names</code> of the list include the <code>target</code> ages that
the coordinates represent.</p>
<p>This might be the structure that is the most efficient for you - but
there might also be cases when you would need to access the coordinates
of the same point at different times quickly. For this purpose, an
<code>array</code> representation of the results might be better suited,
which you can toggle by setting the <code>listout</code> argument to
<code>FALSE</code> from the default (<code>listout=TRUE</code>):</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pmHistory</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="va">posMat</span>, from<span class="op">=</span><span class="fl">220</span>,</span>
<span>  age<span class="op">=</span><span class="va">allAges</span>, warn<span class="op">=</span><span class="cn">FALSE</span>, listout<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Accessing the structure of this object is a simple way to inform
yourself about how to access the desired subsets:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">pmHistory</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:23, 1:3, 1:2] -15 -13.8 -13.2 -13.1 -13.6 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 3</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:23] "220" "210" "200" "190" ...</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:3] "one" "two" "three"</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:2] "paleolong" "paleolat"</span></span></code></pre></div>
<p>This object is a three-dimensional <code>array</code> of coordinates,
with the target <code>age</code>s given as the first dimension (rows),
the points as the second (columns) and the coordinate type
(<code>paleolong</code> or <code>paleolat</code>) as the third
(planes).</p>
<p>For instance, if we want to access the history of point
<code>one</code> we can use character subscripts to have the coordinates
and and the ages in a simple 2D <code>matrix</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># history of point 'one' </span></span>
<span><span class="va">oneHistory</span> <span class="op">&lt;-</span> <span class="va">pmHistory</span><span class="op">[</span>, <span class="st">"one"</span>, <span class="op">]</span></span>
<span><span class="va">twoHistory</span> <span class="op">&lt;-</span> <span class="va">pmHistory</span><span class="op">[</span>, <span class="st">"two"</span>, <span class="op">]</span></span></code></pre></div>
<p>You can use these matrices to display the rotation history of these
points from 220Ma to the present day:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># redraw 220ma map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coast220</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"gray"</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the 220Ma position of point 'two'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">posMat</span>, col<span class="op">=</span><span class="st">"black"</span>, pch<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  present-day coastlines</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coast0</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"#0000DD22"</span>, border<span class="op">=</span><span class="cn">NA</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the 220Ma positions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">presentPoints</span>, col<span class="op">=</span><span class="st">"#0000DD"</span>, pch<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tracing lines</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">oneHistory</span>, col<span class="op">=</span><span class="st">"#0000DD99"</span>, type<span class="op">=</span><span class="st">"o"</span>, cex<span class="op">=</span><span class="fl">0.3</span>, pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">twoHistory</span>, col<span class="op">=</span><span class="st">"#0000DD99"</span>, type<span class="op">=</span><span class="st">"o"</span>, cex<span class="op">=</span><span class="fl">0.3</span>, pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="3_online_reconstrution_forward_files/figure-html/ultimate-1.png" width="960"></p>
<p>This constitutes the overview of the <strong>online method</strong>
of reconstruction.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="advantages-and-disadvantages-of-the-online-method">Advantages and disadvantages of the <em>online method</em><a class="anchor" aria-label="anchor" href="#advantages-and-disadvantages-of-the-online-method"></a>
</h2>
<hr>
<p>Currenly, only this <strong>online method</strong> allows you to do
reverse reconstructions (i.e. to use the paleocoordinates in
calculations). This methods is also easy to set up, but it has several
limitations. For more complete control over the backward rotations you
might want to try out the <strong>offline method</strong> <a href="">(see Tutorial 4 about the Offline Method)</a>.</p>
<p>If want to stick with the <strong>online method</strong>, you need to
be aware of these limiting factors:</p>
<div class="section level4">
<h4 id="external-models">External models<a class="anchor" aria-label="anchor" href="#external-models"></a>
</h4>
<p>Although the <strong>online method</strong> is easy to set up, it
uses-pre defined models to actually execute the rotations. If you cwant
to use customized, or other models, which are not yet implemented in the
GWS, you will need to use the <strong>offline</strong> method.</p>
</div>
<div class="section level4">
<h4 id="internet-connection-and-reproducibility">Internet connection and reproducibility<a class="anchor" aria-label="anchor" href="#internet-connection-and-reproducibility"></a>
</h4>
<p>Since the calculations are not performed on your computer, but by the
servers that host the GWS, you cannot use this method if you have no
internet connection. Also, if you think about reproducibility, it is
easy to see that you have no control over whether this service remains
usable in the future - and neither are we.</p>
<p>There are docker containers that allow you to instantiate the GWS,
which might help with this issue - but if you really want to make sure
that your code remains reproducible - you might want to try the
<strong>offline method instead</strong>.</p>
</div>
<div class="section level4">
<h4 id="rounding-and-data-quantity">Rounding and data quantity<a class="anchor" aria-label="anchor" href="#rounding-and-data-quantity"></a>
</h4>
<p>Earlier versions of <code>rgplates</code>(prior to <code>v0.4</code>)
were submitting coordinates for reconstruction via a URL, which imposed
technical limitations (limited number of points, precision). These
issues have been resolved.</p>
</div>
<div class="section level4">
<h4 id="additional-options">Additional options<a class="anchor" aria-label="anchor" href="#additional-options"></a>
</h4>
<p>There are also some additional options that you can customize, which
are not exposed for you to set in the GWS, which might affect your
results.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://palaeobiology.nat.fau.de/people/instructors/kocsis/" class="external-link">Adam T. Kocsis</a>, <a href="https://www.gzn.nat.fau.eu/palaeontologie/team/wissenschaftler/nussaibah-raja-schoob/" class="external-link">Nussaibah B. Raja</a>, <a href="https://www.dfg.de/en/index.jsp" class="external-link"><img src="https://github.com/adamkocsis/rgplates/blob/devel/pkgdown/assets/dfg.png?raw=true" alt="dfg" width="80"></a>, <a href="https://www.gzn.nat.fau.eu/" class="external-link"><img src="https://github.com/adamkocsis/rgplates/blob/devel/pkgdown/assets/GeoZentrum.svg?raw=true" alt="geozentrum" width="80"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
