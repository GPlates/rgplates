<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to rotate present-day coordinates with the GPlates Web Service
">
<title>2. Reconstructions using modern coordinates (online) • rgplates</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="2. Reconstructions using modern coordinates (online)">
<meta property="og:description" content="Learn how to rotate present-day coordinates with the GPlates Web Service
">
<meta property="og:image" content="https://gplates.github.io/rgplates/reference/figures/logo.png">
<meta property="og:image:alt" content="The rgplates sticker.">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@atkocsis">
<meta name="twitter:site" content="@atkocsis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rgplates</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/1_installation.html">1. Installation</a>
    <a class="dropdown-item" href="../articles/2_online_reconstruction_backwards.html">2. Online Reconstruction with the GWS</a>
    <a class="dropdown-item" href="../articles/3_online_reconstrution_forward.html">3. Online Reconstruction using paleocoordinates</a>
    <a class="dropdown-item" href="../articles/4_offline_reconstruction.html">4. Offline Reconstruction</a>
    <a class="dropdown-item" href="../articles/5_reconstruction_with_chronosphere.html">5. Reconstruction with chronosphere Data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-internals">Internals</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-internals">
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
    <a class="dropdown-item" href="../articles/internals.html">Internal structure</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.evolv-ed.net/">How-to guides on EvolvED</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gplates/rgplates/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>2. Reconstructions using modern coordinates (online)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gplates/rgplates/blob/HEAD/vignettes/2_online_reconstruction_backwards.Rmd" class="external-link"><code>vignettes/2_online_reconstruction_backwards.Rmd</code></a></small>
      <div class="d-none name"><code>2_online_reconstruction_backwards.Rmd</code></div>
    </div>

    
    
<p>Out of the box, the package relies on the <a href="https://gws.gplates.org/" class="external-link">GPlates Web Service (GWS)</a>, an
<strong>online</strong> service that executes paleogeographic rotations
using data provided in URLs. <code>rgplates</code> <strong>(1)</strong>
sends the data to the GWS, which <strong>(2)</strong> calculates
paleocoordinates, and then <strong>(3)</strong> <code>rgplates</code>
reads in the returned result. <strong>For this online method, you have
to be connected to the internet</strong>.</p>
<p>To start, you have to attach the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gplates.github.io/rgplates/">rgplates</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: sf</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<p>When attached, <code>rgplates</code> automatically loads the <a href="https://cran.r-project.org/web/packages/sf/index.html" class="external-link"><em>Simple
Features for R</em> (<code>sf</code>) package</a>, a standard R package
used for processing vector spatial data.</p>
<p><br></p>
<div class="section level2">
<h2 id="reconstructing-plates">Reconstructing plates<a class="anchor" aria-label="anchor" href="#reconstructing-plates"></a>
</h2>
<hr>
<p>All paleocoordinate rotations are executed with the
<code><a href="../reference/reconstruct.html">reconstruct()</a></code> function. The default model used by this is
the <a href="https://www.earthbyte.org/webdav/ftp/Data_Collections/Merdith_etal_2021_ESR/" class="external-link">Merdith
et al. 2021</a>, described <a href="https://www.sciencedirect.com/science/article/abs/pii/S0301926807001635" class="external-link">here</a>.
<em>(If you look at the reference of <code><a href="../reference/reconstruct.html">reconstruct()</a></code>, you can
see that by default <code>model="MERDITH2021"</code>).</em></p>
<p>Every tectonic model relies on plates, which are rotated on the
surface of Earth. Plate positions) can be reconstructed to any age that
the model covers. The present-day positions of the plates can be queried
with the <code><a href="../reference/reconstruct.html">reconstruct()</a></code> function, with a string passed
(<code>static_plates</code> or <code>plate_polygons</code>, depending on
the model) as the first argument, and the target <code>age</code> set to
<code>0</code> (in Ma).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="st">"static_polygons"</span>, age<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">pl0</span></span>
<span><span class="co">#&gt; Simple feature collection with 2391 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -179.99 ymin: -89.99 xmax: 179.99 ymax: 89.99</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                          geometry</span></span>
<span><span class="co">#&gt; 1  POLYGON ((112.0797 39.2348,...</span></span>
<span><span class="co">#&gt; 2  POLYGON ((119.2562 36.6774,...</span></span>
<span><span class="co">#&gt; 3  POLYGON ((130.47 41.99, 130...</span></span>
<span><span class="co">#&gt; 4  POLYGON ((104.7254 40.4621,...</span></span>
<span><span class="co">#&gt; 5  POLYGON ((102.6257 37.6989,...</span></span>
<span><span class="co">#&gt; 6  POLYGON ((104.6209 38.9799,...</span></span>
<span><span class="co">#&gt; 7  POLYGON ((94.0783 73.2609, ...</span></span>
<span><span class="co">#&gt; 8  POLYGON ((122.0576 66.9608,...</span></span>
<span><span class="co">#&gt; 9  POLYGON ((119.9099 61.8243,...</span></span>
<span><span class="co">#&gt; 10 POLYGON ((105.7441 72.3461,...</span></span></code></pre></div>
<p>The <code>rgplates</code> package relies on <a href="https://cran.r-project.org/web/packages/sf/index.html" class="external-link"><code>sf</code></a>
to handle vector spatial data - like the plates. You can do anything
with this that you normally can with and <code>sf</code> object:
manipulate it, change its map projection, export or use it for
calculations. These data are in standard <a href="https://en.wikipedia.org/wiki/Equirectangular_projection" class="external-link">equirectangular
projection</a>, registered with longitude and latitude data in the
<code>WGS84</code> Coordinate Reference System.</p>
<p>You can plot the distribution of plates with the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
function. To focus on the spatial data and not the attributes of the
features (which are technical in nature), you can plot the geometries of
this object.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pl0</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_online_reconstruction_backwards_files/figure-html/presentdayplot-1.png" width="960"></p>
<p>Setting the <code>age</code> argument allows you to access the state
of the plate tectonic configuration at past points in time. The
<code>age</code> argument accepts dates in millions of years. To
reconstruct the position of the plates at around the Early/Late
Cretaceous boundary (approx. 100Ma), you have to set the
<code>age</code> argument to <code>100</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl100</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="st">"static_polygons"</span>, age<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">pl100</span></span>
<span><span class="co">#&gt; Simple feature collection with 1042 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -179.99 ymin: -89.99 xmax: 179.99 ymax: 89.99</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                          geometry</span></span>
<span><span class="co">#&gt; 1  POLYGON ((123.8607 43.0607,...</span></span>
<span><span class="co">#&gt; 2  POLYGON ((131.9549 41.4295,...</span></span>
<span><span class="co">#&gt; 3  POLYGON ((142.9576 47.937, ...</span></span>
<span><span class="co">#&gt; 4  POLYGON ((115.9434 43.2923,...</span></span>
<span><span class="co">#&gt; 5  POLYGON ((114.4442 40.2853,...</span></span>
<span><span class="co">#&gt; 6  POLYGON ((116.192 41.8191, ...</span></span>
<span><span class="co">#&gt; 7  POLYGON ((84.8005 73.1575, ...</span></span>
<span><span class="co">#&gt; 8  POLYGON ((121.8271 71.3283,...</span></span>
<span><span class="co">#&gt; 9  POLYGON ((123.7043 66.1533,...</span></span>
<span><span class="co">#&gt; 10 POLYGON ((97.0729 73.9899, ...</span></span></code></pre></div>
<p>You can plot the results in a similar way:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pl100</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_online_reconstruction_backwards_files/figure-html/elcplot-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="reconstructing-modern-coastlines">Reconstructing modern <code>coastlines</code><a class="anchor" aria-label="anchor" href="#reconstructing-modern-coastlines"></a>
</h2>
<hr>
<p>Note that the result includes oceanic plates as well, which can be
quite distracting when you want to visualize past distribution of the
continents. To help with this, the paleogeographic positions of the
present-day coastlines (and plate margins) can be quite helpful, which
can be accessed, by providing <code>"coastlines"</code> as the first
argument of the <code><a href="../reference/reconstruct.html">reconstruct()</a></code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="st">"coastlines"</span>, age<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">c100</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="st">"coastlines"</span>, age<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">c100</span></span>
<span><span class="co">#&gt; Simple feature collection with 2451 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -179.99 ymin: -89.3928 xmax: 179.99 ymax: 83.1004</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                          geometry</span></span>
<span><span class="co">#&gt; 1  POLYGON ((132.3511 47.0744,...</span></span>
<span><span class="co">#&gt; 2  POLYGON ((141.963 46.5718, ...</span></span>
<span><span class="co">#&gt; 3  POLYGON ((134.1119 44.0571,...</span></span>
<span><span class="co">#&gt; 4  POLYGON ((134.1819 42.4726,...</span></span>
<span><span class="co">#&gt; 5  POLYGON ((133.5996 44.4895,...</span></span>
<span><span class="co">#&gt; 6  POLYGON ((142.7117 48.1375,...</span></span>
<span><span class="co">#&gt; 7  POLYGON ((133.7077 44.7113,...</span></span>
<span><span class="co">#&gt; 8  POLYGON ((133.5384 44.3543,...</span></span>
<span><span class="co">#&gt; 9  POLYGON ((132.7962 42.5404,...</span></span>
<span><span class="co">#&gt; 10 POLYGON ((132.486 42.1309, ...</span></span></code></pre></div>
<p>You can visalize these in the same way:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">c100</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_online_reconstruction_backwards_files/figure-html/tjbcoastplot-1.png" width="960"></p>
<p>Again, the <code>pl0</code> and <code>pl100</code> and
<code>c100</code> objects are <code>sf</code>-class objects. You can
customize their plotting as you would for any other <code>sf</code>
object - for instance setting a fill color for the polygons and not
plotting their boundaries.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pl100</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"gray"</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_online_reconstruction_backwards_files/figure-html/tjbplot2-1.png" width="960"></p>
<p>You can easily plot them on top of each other:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pl100</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"gray"</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">c100</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"darkgray"</span>, border<span class="op">=</span><span class="cn">NA</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_online_reconstruction_backwards_files/figure-html/tjbplot3-1.png" width="960"></p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="individual-locations">Individual locations<a class="anchor" aria-label="anchor" href="#individual-locations"></a>
</h2>
<hr>
<p>This is nice, but plotting the plates on their own has only so much
use. The true use of <code><a href="../reference/reconstruct.html">reconstruct()</a></code> is the ability to
calculate the paleocoordinates of present-day locations for a given
<code>age</code>.</p>
<div class="section level4">
<h4 id="single-present-day-point">Single present-day point<a class="anchor" aria-label="anchor" href="#single-present-day-point"></a>
</h4>
<p>Let’s consider the location of London (<a href="https://www.google.com/maps/place/London,+Egyes%C3%BClt+Kir%C3%A1lys%C3%A1g/@51.528308,-0.3817792,10z/data=!3m1!4b1!4m5!3m4!1s0x47d8a00baf21de75:0x52963a5addd52a99!8m2!3d51.5072178!4d-0.1275862" class="external-link">here
it is on Google maps</a>)! Either in the URL, or with the user interface
of Google maps, you can find that the coordinates of the city center are
around 51.52°N (latitude) and 0.38°W (longitude). To figure out where
the city was at the Triassic/Jurassic boundary you need to:
<strong>(1)</strong> register these coordinates in R; and
<strong>(2)</strong> provide them to the <code><a href="../reference/reconstruct.html">reconstruct()</a></code>
function.</p>
<div class="alert alert-primary" role="info">
<p>Note that we are dealing with global-scale, approximate coordinates
here. For more precise results, always make sure that the CRS of the
points is matching the CRS of the maps (including ellipses)!</p>
</div>
<p>Because with the usually used equirectangular projection the
<em>x</em>-axis of plotting become <em>longitude</em>, and the
<em>y</em> axis becomes latitude, we usually register the coordinates in
the order of longitude first, and latitude second (with easting
longitudes and northing latitudes registered as positive values).</p>
<p>To make this structure absolutely clear, it is best to register
coordinates as 2-column matrices, with <em>longitude</em> being the
<em>first</em>, and <em>latitude</em> the <em>second</em> column:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the coordinates</span></span>
<span><span class="va">london</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.38</span>, <span class="fl">51.52</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make it a matrix</span></span>
<span><span class="va">londonMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">london</span>, ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add column names (optional)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">londonMat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"long"</span>, <span class="st">"lat"</span><span class="op">)</span></span>
<span><span class="va">londonMat</span></span>
<span><span class="co">#&gt;       long   lat</span></span>
<span><span class="co">#&gt; [1,] -0.38 51.52</span></span></code></pre></div>
<p>Since the coordinate reference system (CRS) of the maps is
longitude-latitude, you can use these coordinates directly to indicate
the positionx of the city on the present-day map using
<code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points()</a></code> - in this case with red plus signs:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">c0</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">londonMat</span>, col<span class="op">=</span><span class="st">"red"</span>, pch<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_online_reconstruction_backwards_files/figure-html/presentdayplotlondon-1.png" width="960"></p>
</div>
<div class="section level4">
<h4 id="paleocoordinates-of-a-single-locality">Paleocoordinates of a single locality<a class="anchor" aria-label="anchor" href="#paleocoordinates-of-a-single-locality"></a>
</h4>
<p>Finding the paleocoordinates of such localities is as easy as
calculating those of the plates. You have to use the matrix that you
defined earlier (<code>londonMat</code>) as the first argument, of
<code><a href="../reference/reconstruct.html">reconstruct()</a></code> (where <code>"static_polygons"</code> and
<code>"coastlines"</code> were given earlier), and provide a target age
in million years:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">londonMat100</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="va">londonMat</span>, age<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">londonMat100</span></span>
<span><span class="co">#&gt;      paleolong paleolat</span></span>
<span><span class="co">#&gt; [1,]    16.501  43.4247</span></span></code></pre></div>
<p>The result of this calculation is a similar <code>matrix</code>: now
including the paleolongitude and paleolatitude columns. If you provide
coordinates as a plain <code>matrix</code>, coordinates are inferred to
be longitude and latitude.</p>
<p>You can visualize this the same way, as you visualized the
present-day position of the location:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pl100</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"gray"</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">londonMat100</span>, col<span class="op">=</span><span class="st">"red"</span>, pch<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_online_reconstruction_backwards_files/figure-html/londonPast-1.png" width="960"></p>
</div>
<div class="section level4">
<h4 id="paleocoordinates-of-a-multiple-localities">Paleocoordinates of a multiple localities<a class="anchor" aria-label="anchor" href="#paleocoordinates-of-a-multiple-localities"></a>
</h4>
<p>If you want to reconstruct multiple locations, all you need to
provide is more rows in the matrix. For instance, if you also want to
calculate the positions of <a href="https://www.google.com/maps/place/Sydney+%C3%9Aj-D%C3%A9l-Wales,+Ausztr%C3%A1lia/@-33.8469759,150.3715249,9z/data=!3m1!4b1!4m5!3m4!1s0x6b129838f39a743f:0x3017d681632a850!8m2!3d-33.8688197!4d151.2092955" class="external-link">Sydney,
AU</a> (33.85°S, 151.11°E) and <a href="https://www.google.com/maps/place/Montr%C3%A9al,+Qu%C3%A9bec,+Kanada/@45.5578125,-74.2723072,9z/data=!3m1!4b1!4m5!3m4!1s0x4cc91a541c64b70d:0x654e3138211fefef!8m2!3d45.5018869!4d-73.5673919" class="external-link">Montréal
(CA)</a> (45.52°N, 73.61°W), you need to add these in a similar
fashion.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># coordinates of the two other cities</span></span>
<span><span class="va">sydney</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">151.17</span>, <span class="op">-</span><span class="fl">33.85</span><span class="op">)</span></span>
<span><span class="va">montreal</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">73.61</span>, <span class="fl">45.52</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all cities in a single matrix</span></span>
<span><span class="va">cities</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">london</span>, <span class="va">sydney</span>, <span class="va">montreal</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#optional column names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"long"</span>, <span class="st">"lat"</span><span class="op">)</span></span>
<span><span class="va">cities</span></span>
<span><span class="co">#&gt;            long    lat</span></span>
<span><span class="co">#&gt; london    -0.38  51.52</span></span>
<span><span class="co">#&gt; sydney   151.17 -33.85</span></span>
<span><span class="co">#&gt; montreal -73.61  45.52</span></span></code></pre></div>
<p>Now that we have a matrix of longitudes and latitudes, all we need to
do is use this as the first argument of the <code><a href="../reference/reconstruct.html">reconstruct()</a></code>
function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cities100</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="va">cities</span>, age<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">cities100</span></span>
<span><span class="co">#&gt;          paleolong paleolat</span></span>
<span><span class="co">#&gt; london     16.5010  43.4247</span></span>
<span><span class="co">#&gt; sydney    168.1989 -64.7057</span></span>
<span><span class="co">#&gt; montreal  -24.3468  43.0799</span></span></code></pre></div>
<p>Note that the order of entities remains the same. We can plot these
the same way similar to a single city.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the background map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">c100</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"gray"</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the reconstructed cities </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">cities100</span>, col<span class="op">=</span><span class="st">"red"</span>, pch<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_online_reconstruction_backwards_files/figure-html/citiesPlot-1.png" width="960"></p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="other-reconstruction-models">Other reconstruction models<a class="anchor" aria-label="anchor" href="#other-reconstruction-models"></a>
</h2>
<hr>
<p>If you look into the <a href="../reference/reconstruct.html#details"><em>Details</em> of the
reference of <code>reconstruct()</code></a>, you will see that the
<code>model</code> argument can be set to other character strings
besides <code>"MERDITH2021".</code> These indicate other models that are
accessible via the GPLates Web Service. For instance, if you want to
execute the same calculations to <a href="#reconstructing-plates">reconstruct the position position of the
plates at 100Ma</a>, with the Seton et al. 2012 model, all you have to
do is set <code>model="SETON2012"</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c100seton</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct.html">reconstruct</a></span><span class="op">(</span><span class="st">"coastlines"</span>, age<span class="op">=</span><span class="fl">100</span>, model<span class="op">=</span><span class="st">"SETON2012"</span><span class="op">)</span></span>
<span><span class="va">c100seton</span></span>
<span><span class="co">#&gt; Simple feature collection with 1893 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -179.99 ymin: -89.99 xmax: 179.99 ymax: 85.6335</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                          geometry</span></span>
<span><span class="co">#&gt; 1  POLYGON ((-10.7862 27.3367,...</span></span>
<span><span class="co">#&gt; 2  POLYGON ((-141.3289 -23.446...</span></span>
<span><span class="co">#&gt; 3  POLYGON ((-60.5945 5.9602, ...</span></span>
<span><span class="co">#&gt; 4  POLYGON ((-59.9848 4.8269, ...</span></span>
<span><span class="co">#&gt; 5  POLYGON ((-36.5397 16.789, ...</span></span>
<span><span class="co">#&gt; 6  POLYGON ((-36.7068 16.8855,...</span></span>
<span><span class="co">#&gt; 7  POLYGON ((-36.494 16.7124, ...</span></span>
<span><span class="co">#&gt; 8  POLYGON ((-36.3418 16.5887,...</span></span>
<span><span class="co">#&gt; 9  POLYGON ((-12.5495 22.9016,...</span></span>
<span><span class="co">#&gt; 10 POLYGON ((-10.4138 22.3064,...</span></span></code></pre></div>
<p>You can compare this with the Merdith et al. model, by plotting this
result on top of that with some transparency (e.g. a semi-transparent
red, in <a href="https://www.w3schools.com/css/css_colors_rgb.asp" class="external-link">HTML
RGBA</a>: <code>"#FF000077"</code>):</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">c100</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"gray"</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">c100seton</span><span class="op">$</span><span class="va">geometry</span>, col<span class="op">=</span><span class="st">"#FF000077"</span>, add<span class="op">=</span><span class="cn">TRUE</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_online_reconstruction_backwards_files/figure-html/platescompare-1.png" width="960"></p>
<p>You can see that the the two reconstructions differ quite a bit,
which becomes more apparent as we go back in time. Also, with the
transparency, you can see how the plates overlap in convergent
zones.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://palaeobiology.nat.fau.de/people/instructors/kocsis/" class="external-link">Adam T. Kocsis</a>, <a href="https://www.dfg.de/en/index.jsp" class="external-link"><img src="https://github.com/gplates/rgplates/blob/devel/pkgdown/assets/dfg.png?raw=true" alt="dfg" width="80"></a>, <a href="https://www.gzn.nat.fau.eu/" class="external-link"><img src="https://github.com/gplates/rgplates/blob/devel/pkgdown/assets/GeoZentrum.svg?raw=true" alt="geozentrum" width="80"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
